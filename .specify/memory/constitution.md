<!--\nSYNC IMPACT REPORT\nVersion change: N/A -> 1.0.0\nModified principles: None (new constitution)\nAdded sections: All principles and governance sections\nRemoved sections: None\nTemplates requiring updates: \n  - ✅ plan-template.md updated to align with new principles\n  - ✅ spec-template.md updated to align with new principles  \n  - ✅ tasks-template.md updated to align with new principles\n  - ✅ checklist-template.md updated to align with new principles\n  - ⚠️ README.md pending (file does not exist)\nFollow-up TODOs: None\n-->\n\n# Phase III Constitution\n\n## Core Principles\n\n### I. Strict Spec-Driven Development\nAll development follows a spec-driven workflow with no manual coding. Specifications must be refined until perfect output is achieved from Qwen Code CLI. No implementation proceeds without complete, validated specs.\n\n### II. Reusable Intelligence Architecture\nMandatory use of sub-agents and skills for all code generation. Leverage specialized agents (frontend-ui, backend-architect, auth-specialist, security-isolator, spec-validator) and reusable skills (jwt-middleware, fastapi-crud, neon-db-setup, nextjs-component, user-isolation-filter) for all implementations.\n\n### III. Full Integration with Existing System\nComplete integration with Phase II full-stack Todo application. Chatbot must call existing FastAPI endpoints at /api/{user_id}/tasks... with Bearer token from Better Auth. Maintain backward compatibility and leverage existing infrastructure.\n\n### IV. Absolute User Isolation & Security\nEvery operation must be filtered by authenticated user_id from JWT token. No data leaks between users are acceptable. Enforce 401/403 errors appropriately. Security vulnerabilities are non-negotiable.\n\n### V. Stateless Server Architecture\nMaintain stateless server design with conversation state persisted in Neon DB using Conversation and Message models. Server must be ready for horizontal scaling without holding any session state in memory.\n\n### VI. Cohere API Integration\nUse Cohere API key for all AI operations. Adapt any OpenAI SDK code to work with Cohere's equivalent endpoints for agent runner and tool calling. Ensure seamless AI functionality through Cohere's services.\n\n### VII. MCP Tools Standard\nExpose task operations (add_task, list_tasks, complete_task, delete_task, update_task) via Official MCP SDK. All tool integrations must follow MCP standards for interoperability and consistency.\n\n### VIII. Clean, Modular, Secure Code Standards\nImplement async operations, Pydantic validation, comprehensive error handling, and eliminate all vulnerabilities. Code must be clean, maintainable, and follow security best practices throughout the codebase.\n\n### IX. Frontend Excellence\nBuild Next.js 14+ App Router interface with integrated chatbot UI component. Adapt OpenAI ChatKit for Cohere compatibility. Ensure responsive, intuitive user experience that seamlessly integrates with existing dashboard.\n\n### X. Backend Integrity\nExtend existing FastAPI with MCP server using Official MCP SDK for tool exposure. Maintain consistent API design patterns, error handling, and authentication flows across all endpoints.\n\n### XI. Database Persistence\nExtend existing Neon PostgreSQL schema with Conversation (user_id, id, created_at, updated_at) and Message (user_id, id, conversation_id, role, content, created_at) models. Ensure data integrity and proper indexing.\n\n### XII. Authentication Compliance\nIntegrate Better Auth JWT from frontend session, passing to backend API calls securely. Maintain consistent authentication patterns across all components and enforce proper token validation.\n\n## Development Standards\n\nTechnology Stack: Next.js 14+, FastAPI, Neon PostgreSQL, Better Auth, Cohere API, Official MCP SDK\nEnvironment Variables: BETTER_AUTH_SECRET for JWT, DATABASE_URL for Neon, COHERE_API_KEY for Cohere\nTesting: Comprehensive local and production testing with user isolation enforced\nSpecs History: All iterations saved in specs/history/ folder with versioned files\n\n## Development Workflow\n\nAll code generation via Qwen Code CLI with sub-agent utilization. No manual coding permitted. Specs must be validated before implementation. Continuous integration with automated testing and security scanning.\n\n## Governance\n\nThis constitution supersedes all other development practices. Amendments require formal documentation, approval, and migration planning. All pull requests and reviews must verify compliance with these principles. Complexity must be justified with clear benefits.\n\n**Version**: 1.0.0 | **Ratified**: 2026-02-07 | **Last Amended**: 2026-02-07